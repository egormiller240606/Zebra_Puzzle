# Zebra Puzzle Simulation

## Описание
Симуляция "Zebra Puzzle" — агентная модель с путешествиями между домами, обменами питомцами и обновлением знаний. Агенты (жители) ездят по географии, обмениваются информацией при встречах и питомцами случайно. Модель дискретно-событийная с приоритетами событий.

## Запуск
1. Файлы данных: `zebra-01.csv`, `ZEBRA-strategies.csv`, `ZEBRA-geo.csv` в той же папке.
2. Вывод: CSV-лог событий (event_number;time;event_type;details), затем знания агентов (dict {agent_id: info}).

## Структура данных
- **zebra-01.csv**: Инициализация агентов/домов.
  - Формат: house_id;color;nation;drink;smoke;pet
  - Пример: 1;Red;Russian;Water;Marlboro;Dog
- **ZEBRA-strategies.csv**: Стратегии агентов.
  - Формат: agent_id;nation;route_prob1;route_prob2;...;route_prob6;house_exch_prob;pet_exch_prob
  - route_prob — вероятность поездки в дом цвета index (1-6).
  - exch_prob — % готовности к обмену (домами/питомцами).
- **ZEBRA-geo.csv**: Матрица расстояний.
  - Формат: house_id;color;dist_to_1;dist_to_2;...;dist_to_6
  - NA — недоступный маршрут.

## Ключевые классы
- **Agent**: Агент с атрибутами (id, nation, drink, etc.), методами выбора цели (по цветам/вероятностям), обновления знаний.
- **House**: Дом с владельцем, присутствующими агентами.
- **Event**: Базовый класс событий (StartTrip, FinishTrip, ChangePet).
  - StartTrip: Начало поездки, проверка пути, планировка FinishTrip.
  - FinishTrip: Завершение, обновление локации, обмен знаний при успехе (владелец дома присутствует).
  - ChangePet: Обмен питомцами (циклический), обновление знаний всех присутствующих.
- **Environment**: Управляет симуляцией — очередь событий (heap), время, методы обработки батчей, генерации обменов, планировки поездок.

## Логика симуляции
- Инициализация: Агенты дома, планируют первую поездку.
- Цикл: Извлекаем события по времени, обрабатываем с приоритетами (FinishTrip > Exchange > StartTrip).
- После FinishTrip: Генерируем обмены (если агенты готовы), планируем новые поездки (домой — новая цель; не дома — возвращение).
- Остановка: Время > max_time (по умолчанию 10) или пустая очередь.

## Пример лога
1;0;StartTrip;Russian;1;6  # Russian едет из 1 в 6
7;1;FinishTrip;0;Russian;6  # Прибыл, не встретил владельца
13;5;StartTrip;Russian;6;1  # План возвращения домой
...
